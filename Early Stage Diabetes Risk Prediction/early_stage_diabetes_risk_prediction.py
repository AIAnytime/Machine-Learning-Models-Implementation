# -*- coding: utf-8 -*-
"""Early Stage Diabetes Risk Prediction.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1Jb9Dc00oyFFACt9iTebHu6Cyk61ztiAU
"""

!pip install pycaret

import pycaret.classification as pyc

dir(pyc)

# Commented out IPython magic to ensure Python compatibility.
import pandas as pd 
import numpy as np 
import matplotlib.pyplot as plt
# %matplotlib inline

data = pd.read_csv("drive/My Drive/healthcare/diabetes_data_upload.csv")

data

data.info()

pyc.setup(
    data = data,
    target = 'class',
    train_size = 0.7,
    normalize = True
)

pyc.compare_models()

best_model = pyc.create_model('rf')

best_model

pyc.evaluate_model(best_model)

unseen_data = data.iloc[[0,1, 2, 3], :-1]

print(unseen_data)

prediction = pyc.predict_model(best_model, data=unseen_data)
print(prediction)

# save the result
result = prediction.to_csv("drive/My Drive/healthcare/result.csv")

# save the model
pyc.save_model(best_model, "drive/My Drive/healthcare/mlmodel")

